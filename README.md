# RDF Conversion Workflow 

## About the Workflow

Originally, this workflow has been developed to convert a phenopacket v2 dataset to an RDF dataset complying with the [phenopacket v2 conceptual model](https://github.com/LUMC-BioSemantics/phenopackets-rdf-schema/tree/v2) that has been designed to work well on RDF data and align with Care-SM. This final version of the workflow can be found in the main branch with the relevant input and output files. 

In order to develop this workflow further in increasing its generalization over many other SHACL models that might be used as input of this workflow, more SHACL models are looked into. At the moment, the workflow has been tested on the Health-RI metadata model represented in SHACL found [here](https://github.com/Health-RI/health-ri-metadata/tree/v1.0.0/Formalisation(shacl)/Core/PiecesShape). More SHACL design patterns have been introduced by this metadata model which resulted in the workflow to be insufficiently generalized in order to output JSON and YARRRML files that correctly converts to RDF for this model. 

As this RDF conversion workflow proved to be useful for automatic conversion of phenopacket data and insightful about the implications of changes in the SHACL file on the actual data, more development of this tool is recommended. In this branch, the workflow has already been modified to implement the improvements. However, more steps need to be taken to implement the functionalities of the tool to work properly on the new SHACL models. 

## Implemented Improvements

In the current workflow version, the namespaces declared in the SHACL files needed to be defined manually to the script:

https://github.com/rosazwart/phenopackets-v2-rdf-schema/blob/445d6db863ddb2e82379573c417adad487a96652/shacl2yarrrml/namespace_provider.py#L23-L25

In this new version, these namespaces are detected automatically and a prompt is given to the user when starting the SHACL2YARRRML script asking which namespace and prefix need to be used to add to the RDF entities that are to be created.

## Future Work

This branch contains the work in progress of the improved version of the RDF conversion workflow. The main improvements that are worked on at the moment are also summarized by the added issues to this branch.

The following improvements are needed to be implemented:

- Increase generalization by looking at more model representation syntax possibilities.
- Implement the new structures of the JSON templates and generation of a complementary YARRRML file (see Issues).
- Automate the alignment between any given JSON or CSV file and the JSON template generated by the SHACL2YARRRML converter (ideally, a user-friendly UI where the user can drag and drop the correct datafields from their data to the datafields required for creating the RDF that complies with the conceptual model expressed in SHACL and where the index values that are needed in the JSON input are generated automatically such that the user does not have to deal with this).
- The conversion from YARRRML to RDF is currently implemented by automating the interaction with [YARRRML Matey](https://rml.io/yarrrml/matey/#) using selenium. Ideally, the conversion is done without using a browser-based application.
- Add a tool that can verify whether the given SHACL model does not contain syntax that is not expected by the converter tool such that the user can be informed beforehand whether this RDF conversion tool is suitable for their model. 
